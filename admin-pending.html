<!DOCTYPE html>
<html>
<head>
    <title>Pending Deposits</title>
    <meta charset="UTF-8">
</head>
<body>

<h2>Pending Deposits</h2>
<div id="pendingList"></div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const pendingList = document.getElementById("pendingList");
        let deposits = JSON.parse(localStorage.getItem("pendingDeposits") || "[]");
        let users = JSON.parse(localStorage.getItem("users") || "[]");

        if (deposits.length === 0) {
            pendingList.innerHTML = "<p>à¦•à§‹à¦¨à§‹ pending deposit à¦¨à§‡à¦‡</p>";
            return;
        }

        deposits.forEach((item, index) => {
            const box = document.createElement("div");
            box.innerHTML = `
                <p>ðŸ“±User: ${item.user}</p>
                <p>ðŸ’°Amount: ${item.amount} à¦Ÿà¦¾à¦•à¦¾</p>
                <p>ðŸ“¦Method: ${item.method}</p>
                <p>ðŸ”‘TrxID: ${item.trxid}</p>
                <p>ðŸ“…Date: ${item.date}</p>
                <button onclick="approve(${index})">Approve</button>
                <button onclick="reject(${index})">Reject</button>
            `;
            pendingList.appendChild(box);
        });
    });

    function approve(i) {
        let deposits = JSON.parse(localStorage.getItem("pendingDeposits") || "[]");
        let users = JSON.parse(localStorage.getItem("users") || "[]");

        const dep = deposits[i];

        let user = users.find(u => u.phone === dep.user);
        user.balance += dep.amount;

        deposits.splice(i, 1);

        localStorage.setItem("users", JSON.stringify(users));
        localStorage.setItem("pendingDeposits", JSON.stringify(deposits));

        alert("Approved!");
        location.reload();
    }

    function reject(i) {
        let deposits = JSON.parse(localStorage.getItem("pendingDeposits") || "[]");
        deposits.splice(i, 1);
        localStorage.setItem("pendingDeposits", JSON.stringify(deposits));
        location.reload();
    }
</script>

</body>
</html>
